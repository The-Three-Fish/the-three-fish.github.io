<!DOCTYPE html><html lang="en"> <head><!-- favicon --><link rel="shortcut icon" href="/images/s-logo-blue.jpg"><!-- theme meta --><meta name="theme-name" content="bigspring-light-astro"><meta name="msapplication-TileColor" content="#000000"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.16.19"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- google font css --><style>@font-face {font-weight: 300;font-style: normal;font-family: Lato;font-display: swap;src: url(https://fonts.gstatic.com/s/lato/v25/S6u9w4BMUTPHh7USew8.ttf)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Lato;font-display: swap;src: url(https://fonts.gstatic.com/s/lato/v25/S6uyw4BMUTPHvxk.ttf)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Lato;font-display: swap;src: url(https://fonts.gstatic.com/s/lato/v25/S6u9w4BMUTPHh6UVew8.ttf)}</style><style>:root{ --font-primary: Lato, '_font_fallback_1342231700038', sans-serif; } @font-face { font-family: '_font_fallback_1342231700038'; size-adjust: 97.84%; src: local('Arial'); ascent-override: 100.88%; descent-override: 21.77%; line-gap-override: 0.00%; }</style><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><!-- title --><title>
      搭建oTree经济学实验基础结构：从零到一的详细教程
    </title><!-- canonical url --><!-- noindex robots --><!-- meta-description --><meta name="description" content="Heading example Here is example of hedings. You can use this heading by following markdownify rules."><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- author from config.json --><meta name="author" content="rowan2024"><!-- og-title --><meta property="og:title" content="搭建oTree经济学实验基础结构：从零到一的详细教程"><!-- og-description --><meta property="og:description" content="Heading example Here is example of hedings. You can use this heading by following markdownify rules."><meta property="og:type" content="website"><meta property="og:url" content="https://the-three-fish.github.io/blog/risk-preferences"><!-- twitter-title --><meta name="twitter:title" content="搭建oTree经济学实验基础结构：从零到一的详细教程"><!-- twitter-description --><meta name="twitter:description" content="Heading example Here is example of hedings. You can use this heading by following markdownify rules."><!-- og-image --><meta property="og:image" content="https://the-three-fish.github.io/images/blog-1.jpg"><!-- twitter-image --><meta name="twitter:image" content="https://the-three-fish.github.io/images/blog-1.jpg"><meta name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/_astro/_regular_.DbxnYC6o.css"><script type="module" src="/_astro/hoisted.BT380aKz.js"></script></head> <body>  <header class="header"> <nav class="navbar container"> <!-- logo --> <div class="order-0"> <a href="/" class="navbar-brand block md:w-[150px] lg:w-auto"> <img src="/images/logo5.png" alt="oTree Study" style="height:38px;width:200px" width="400" height="76" loading="lazy" decoding="async"> </a> </div> <!-- navbar toggler --> <input id="nav-toggle" type="checkbox" class="hidden"> <label id="show-button" for="nav-toggle" class="order-2 flex cursor-pointer items-center md:order-1 md:hidden"> <svg class="h-6 fill-current" viewBox="0 0 20 20"> <title>Menu Open</title> <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path> </svg> </label> <label id="hide-button" for="nav-toggle" class="order-2 cursor-pointer items-center md:order-1"> <svg class="h-6 fill-current" viewBox="0 0 20 20"> <title>Menu Close</title> <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"></polygon> </svg> </label> <!-- /navbar toggler --> <ul id="nav-menu" class="navbar-nav order-3 hidden w-full md:order-1 md:flex md:w-auto md:space-x-3"> <li class="nav-item"> <a href="/" class="nav-link block false"> Home </a> </li><li class="nav-item"> <a href="/blog" class="nav-link block false"> Blog </a> </li><li class="nav-item"> <a href="/pricing" class="nav-link block false"> Pricing </a> </li><li class="nav-item"> <a href="/contact" class="nav-link block false"> Contact </a> </li><li class="nav-item"> <a href="/faq" class="nav-link block false"> FAQ </a> </li> <div class="block md:hidden"> <a class="btn btn-primary z-0 ml-auto py-[14px]" href="/contact"> Get Started </a> </div> </ul> <div class="order-1 ml-auto hidden items-center md:order-2 md:ml-0 md:flex md:min-w-[150px] lg:min-w-[200px]"> <a class="btn btn-primary z-0 ml-auto py-[14px]" href="/contact"> Get Started </a> </div> </nav> </header> <main id="main-content">  <section class="section"> <div class="container"> <div class="row justify-center"> <div class="col-12 md:col-8"> <article class="text-center"> <img src="/images/blog-1.jpg" alt="搭建oTree经济学实验基础结构：从零到一的详细教程" class="rounded-lg" width="1000" height="500" loading="lazy" decoding="async"> <h1 class="h2 text-left my-6">搭建oTree经济学实验基础结构：从零到一的详细教程</h1> <div class="content mb-16 text-left"> <p><em>发表于 [otree Study] • 2025年5月 • 阅读时间12分钟</em></p>
<h2 id="引言">引言</h2>
<p>作为一名使用oTree平台多年的开发者，我深知初学者在设计第一个经济学实验时面临的挑战。本教程将带领大家创建一个风险偏好测量实验，采用价格列表法（类似于Holt和Laury, 2002的经典设计）。通过这个过程，你将掌握如何构建一个功能完善的实验来准确测量参与者的风险态度。</p>
<h2 id="otree简介">oTree简介</h2>
<p>oTree是一个基于Python的开源行为研究平台。在实验经济学领域广受欢迎的主要原因是它能够支持复杂逻辑、随机化处理以及参与者之间的互动决策 — 这些都是经济学实验的核心要素。多年来，我看到oTree已经成为实验经济学领域的主流工具，其灵活性和强大功能让研究者能够实现各种实验设计。</p>
<h2 id="前期准备">前期准备</h2>
<p>在开始之前，请确保你已准备好：</p>
<ul>
<li>Python 3.12环境</li>
<li>安装好oTree（<code>pip install otree</code>）</li>
<li>基本的Python编程知识</li>
<li>文本编辑器或IDE（我个人推荐配置Python扩展的VS Code）</li>
</ul>
<h2 id="项目结构概览">项目结构概览</h2>
<p>一个典型的oTree实验通常包含以下关键文件：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>risk_preferences/</span></span>
<span class="line"><span>├── __init__.py</span></span>
<span class="line"><span>├── _builtin/</span></span>
<span class="line"><span>├── models.py        # 定义数据结构和核心逻辑</span></span>
<span class="line"><span>├── pages.py         # 控制页面的顺序和流程</span></span>
<span class="line"><span>├── templates/       # 每个页面的HTML模板</span></span>
<span class="line"><span>│   └── risk_preferences/</span></span>
<span class="line"><span>│       ├── Introduction.html</span></span>
<span class="line"><span>│       ├── Decision.html</span></span>
<span class="line"><span>│       └── Results.html</span></span>
<span class="line"><span>└── settings.py      # 配置设置</span></span>
<span class="line"><span></span></span></code></pre>
<p>让我们一步步构建这个项目。</p>
<h2 id="第一步创建项目">第一步：创建项目</h2>
<p>首先，创建一个新的oTree项目：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#61AFEF">otree</span><span style="color:#98C379"> startproject</span><span style="color:#98C379"> risk_experiment</span></span>
<span class="line"><span style="color:#56B6C2">cd</span><span style="color:#98C379"> risk_experiment</span></span>
<span class="line"></span></code></pre>
<p>然后在这个项目中创建一个新的应用：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#61AFEF">otree</span><span style="color:#98C379"> startapp</span><span style="color:#98C379"> risk_preferences</span></span>
<span class="line"></span></code></pre>
<h2 id="第二步定义经济模型">第二步：定义经济模型</h2>
<p>编辑<code>models.py</code>文件来定义我们的风险偏好测量任务。我将创建一个包含10个决策的价格列表，每个决策要求参与者在安全选项和风险选项之间做出选择：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#C678DD">from</span><span style="color:#ABB2BF"> otree.api </span><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#ABB2BF">    models, BaseConstants, BaseSubsession, BaseGroup, BasePlayer,</span></span>
<span class="line"><span style="color:#ABB2BF">    Currency </span><span style="color:#C678DD">as</span><span style="color:#ABB2BF"> c, Page</span></span>
<span class="line"><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> random</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> C</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BaseConstants</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#D19A66">    NAME_IN_URL</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'risk_preferences'</span></span>
<span class="line"><span style="color:#D19A66">    PLAYERS_PER_GROUP</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> None</span></span>
<span class="line"><span style="color:#D19A66">    NUM_ROUNDS</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 1</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # 定义安全选项和风险选项的收益</span></span>
<span class="line"><span style="color:#ABB2BF">    safe_option_a </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> c</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">2.00</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    safe_option_b </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> c</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1.60</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    risky_option_a </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> c</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">3.85</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    risky_option_b </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> c</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">0.10</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # 10个决策的概率（百分比）</span></span>
<span class="line"><span style="color:#ABB2BF">    probabilities </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> [</span><span style="color:#D19A66">10</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">20</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">30</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">40</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">50</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">60</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">70</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">80</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">90</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Subsession</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BaseSubsession</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#C678DD">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Group</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BaseGroup</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#C678DD">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Player</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BasePlayer</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # 用于存储10个决策的字段（0 = 安全选项，1 = 风险选项）</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_1 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_2 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_3 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_4 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_5 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_6 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_7 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_8 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_9 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">    decision_10 </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">choices</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[[</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项A'</span><span style="color:#ABB2BF">], [</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">'选项B'</span><span style="color:#ABB2BF">]])</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # 用于存储被选中结算的决策编号和结果</span></span>
<span class="line"><span style="color:#ABB2BF">    paying_decision </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">IntegerField</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    outcome </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> models.</span><span style="color:#61AFEF">BooleanField</span><span style="color:#ABB2BF">()  </span><span style="color:#7F848E;font-style:italic"># True = 高收益，False = 低收益</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # 计算收益的方法</span></span>
<span class="line"><span style="color:#C678DD">    def</span><span style="color:#61AFEF"> determine_payoff</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B;font-style:italic">self</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # 随机选择一个决策用于支付</span></span>
<span class="line"><span style="color:#E5C07B">        self</span><span style="color:#ABB2BF">.paying_decision </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> random.</span><span style="color:#61AFEF">randint</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">10</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # 获取该决策的选择（0 = 安全选项，1 = 风险选项）</span></span>
<span class="line"><span style="color:#ABB2BF">        decision_attr </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> f</span><span style="color:#98C379">'decision_</span><span style="color:#D19A66">{</span><span style="color:#E5C07B">self</span><span style="color:#ABB2BF">.paying_decision</span><span style="color:#D19A66">}</span><span style="color:#98C379">'</span></span>
<span class="line"><span style="color:#ABB2BF">        choice </span><span style="color:#56B6C2">=</span><span style="color:#56B6C2"> getattr</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">self</span><span style="color:#ABB2BF">, decision_attr)</span></span>
<span class="line"><span style="color:#ABB2BF">      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # 获取所选决策的概率</span></span>
<span class="line"><span style="color:#ABB2BF">        prob </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> C.probabilities[</span><span style="color:#E5C07B">self</span><span style="color:#ABB2BF">.paying_decision </span><span style="color:#56B6C2">-</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">]</span></span>
<span class="line"><span style="color:#ABB2BF">      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # 确定结果（成功与否）</span></span>
<span class="line"><span style="color:#E5C07B">        self</span><span style="color:#ABB2BF">.outcome </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> random.</span><span style="color:#61AFEF">random</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">*</span><span style="color:#D19A66"> 100</span><span style="color:#56B6C2"> &#x3C;=</span><span style="color:#ABB2BF"> prob</span></span>
<span class="line"><span style="color:#ABB2BF">      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # 根据选择和结果计算收益</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> choice </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> 0</span><span style="color:#ABB2BF">:  </span><span style="color:#7F848E;font-style:italic"># 选择了安全选项</span></span>
<span class="line"><span style="color:#E5C07B">            self</span><span style="color:#ABB2BF">.payoff </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> C.safe_option_a </span><span style="color:#C678DD">if</span><span style="color:#E5C07B"> self</span><span style="color:#ABB2BF">.outcome </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> C.safe_option_b</span></span>
<span class="line"><span style="color:#C678DD">        else</span><span style="color:#ABB2BF">:  </span><span style="color:#7F848E;font-style:italic"># 选择了风险选项</span></span>
<span class="line"><span style="color:#E5C07B">            self</span><span style="color:#ABB2BF">.payoff </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> C.risky_option_a </span><span style="color:#C678DD">if</span><span style="color:#E5C07B"> self</span><span style="color:#ABB2BF">.outcome </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> C.risky_option_b</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<p>在我多年的oTree编程经验中，我发现清晰定义常量和变量是保证实验可靠性的关键。注意上面代码中如何使用类属性来规范地组织实验参数。</p>
<h2 id="第三步创建页面流程">第三步：创建页面流程</h2>
<p>现在，让我们在<code>pages.py</code>中定义页面序列：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Introduction</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Page</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#98C379">    """介绍页面，包含实验说明"""</span></span>
<span class="line"><span style="color:#C678DD">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Decision</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Page</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#98C379">    """参与者做决策的页面"""</span></span>
<span class="line"><span style="color:#ABB2BF">    form_model </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> 'player'</span></span>
<span class="line"><span style="color:#ABB2BF">    form_fields </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> [</span><span style="color:#C678DD">f</span><span style="color:#98C379">'decision_</span><span style="color:#D19A66">{</span><span style="color:#ABB2BF">i</span><span style="color:#D19A66">}</span><span style="color:#98C379">'</span><span style="color:#C678DD"> for</span><span style="color:#ABB2BF"> i </span><span style="color:#C678DD">in</span><span style="color:#56B6C2"> range</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">11</span><span style="color:#ABB2BF">)]</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#C678DD">    def</span><span style="color:#61AFEF"> vars_for_template</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66;font-style:italic">player</span><span style="color:#ABB2BF">: Player):</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        # Calculate probability pairs for each decision</span></span>
<span class="line"><span style="color:#ABB2BF">        probability_pairs </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> [(p, </span><span style="color:#D19A66">100</span><span style="color:#56B6C2"> -</span><span style="color:#ABB2BF"> p) </span><span style="color:#C678DD">for</span><span style="color:#ABB2BF"> p </span><span style="color:#C678DD">in</span><span style="color:#ABB2BF"> C.probabilities]</span></span>
<span class="line"><span style="color:#ABB2BF">        </span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#98C379">            'probability_pairs'</span><span style="color:#ABB2BF">: probability_pairs,</span></span>
<span class="line"><span style="color:#98C379">            'safe_option_a'</span><span style="color:#ABB2BF">: C.safe_option_a,</span></span>
<span class="line"><span style="color:#98C379">            'safe_option_b'</span><span style="color:#ABB2BF">: C.safe_option_b,</span></span>
<span class="line"><span style="color:#98C379">            'risky_option_a'</span><span style="color:#ABB2BF">: C.risky_option_a,</span></span>
<span class="line"><span style="color:#98C379">            'risky_option_b'</span><span style="color:#ABB2BF">: C.risky_option_b,</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">        </span></span>
<span class="line"><span style="color:#61AFEF">    @</span><span style="color:#56B6C2">staticmethod</span></span>
<span class="line"><span style="color:#C678DD">    def</span><span style="color:#61AFEF"> before_next_page</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66;font-style:italic">player</span><span style="color:#ABB2BF">: Player, </span><span style="color:#D19A66;font-style:italic">timeout_happened</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#ABB2BF">        player.</span><span style="color:#61AFEF">determine_payoff</span><span style="color:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> Results</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Page</span><span style="color:#ABB2BF">):</span></span>
<span class="line"><span style="color:#98C379">    """显示结果和收益的页面"""</span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#C678DD">    def</span><span style="color:#61AFEF"> vars_for_template</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66;font-style:italic">player</span><span style="color:#ABB2BF">: Player):</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#98C379">            'paying_decision'</span><span style="color:#ABB2BF">: player.paying_decision,</span></span>
<span class="line"><span style="color:#98C379">            'probability'</span><span style="color:#ABB2BF">: C.probabilities[player.paying_decision </span><span style="color:#56B6C2">-</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">],</span></span>
<span class="line"><span style="color:#98C379">            'choice'</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">'选项A（安全）'</span><span style="color:#C678DD"> if</span><span style="color:#56B6C2"> getattr</span><span style="color:#ABB2BF">(player, </span><span style="color:#C678DD">f</span><span style="color:#98C379">'decision_</span><span style="color:#D19A66">{</span><span style="color:#ABB2BF">player.paying_decision</span><span style="color:#D19A66">}</span><span style="color:#98C379">'</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> 0</span><span style="color:#C678DD"> else</span><span style="color:#98C379"> '选项B（风险）'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379">            'outcome'</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">'高'</span><span style="color:#C678DD"> if</span><span style="color:#ABB2BF"> player.outcome </span><span style="color:#C678DD">else</span><span style="color:#98C379"> '低'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379">            'payoff'</span><span style="color:#ABB2BF">: player.payoff,</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">page_sequence </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> [Introduction, Decision, Results]</span></span>
<span class="line"></span></code></pre>
<p>这里我运用了一个专业技巧：使用列表推导式（<code>[f'decision_{i}' for i in range(1, 11)]</code>）来简洁地定义表单字段，这是一种我在实际项目中常用的高效编程方式。</p>
<h2 id="第四步创建html模板">第四步：创建HTML模板</h2>
<p>现在，让我们为每个页面创建HTML模板。</p>
<p>首先是<code>Introduction.html</code>：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">{{ extends "global/Page.html" }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ load otree }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block title }}</span></span>
<span class="line"><span style="color:#ABB2BF">    风险偏好实验介绍</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block content }}</span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card"</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card-body"</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">h5</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card-title"</span><span style="color:#ABB2BF">>欢迎参加风险偏好实验&#x3C;/</span><span style="color:#E06C75">h5</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                在本实验中，您将连续做出10个决策，每次在两个选项之间选择：</span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">ul</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">li</span><span style="color:#ABB2BF">>&#x3C;</span><span style="color:#E06C75">strong</span><span style="color:#ABB2BF">>选项A（安全）：&#x3C;/</span><span style="color:#E06C75">strong</span><span style="color:#ABB2BF">> {{ C.safe_option_a }} 的概率为P%，或 {{ C.safe_option_b }} 的概率为(100-P)%&#x3C;/</span><span style="color:#E06C75">li</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">li</span><span style="color:#ABB2BF">>&#x3C;</span><span style="color:#E06C75">strong</span><span style="color:#ABB2BF">>选项B（风险）：&#x3C;/</span><span style="color:#E06C75">strong</span><span style="color:#ABB2BF">> {{ C.risky_option_a }} 的概率为P%，或 {{ C.risky_option_b }} 的概率为(100-P)%&#x3C;/</span><span style="color:#E06C75">li</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;/</span><span style="color:#E06C75">ul</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                概率P在10个决策中从10%递增到100%。</span></span>
<span class="line"><span style="color:#ABB2BF">                实验结束时，系统会随机选择一个决策用于支付，</span></span>
<span class="line"><span style="color:#ABB2BF">                结果将根据该决策对应的概率来确定。</span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    {{ next_button }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span></code></pre>
<p>接下来是<code>Decision.html</code>：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">{{ extends "global/Page.html" }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ load otree }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block title }}</span></span>
<span class="line"><span style="color:#ABB2BF">    您的决策</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block content }}</span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>请在下面10个决策中，每次选择选项A或选项B：&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">  </span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;</span><span style="color:#E06C75">table</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"table table-striped"</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;</span><span style="color:#E06C75">thead</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">tr</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">>决策&#x3C;/</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">>高收益概率&#x3C;/</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">>选项A（安全）&#x3C;/</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">>选项B（风险）&#x3C;/</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">>您的选择&#x3C;/</span><span style="color:#E06C75">th</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;/</span><span style="color:#E06C75">tr</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;/</span><span style="color:#E06C75">thead</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;</span><span style="color:#E06C75">tbody</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            {{ for prob_pair in probability_pairs }}</span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;</span><span style="color:#E06C75">tr</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">>{{ forloop.counter }}&#x3C;/</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">>{{ prob_pair.0 }}%&#x3C;/</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">>{{ safe_option_a }} 概率 {{ prob_pair.0 }}%&#x3C;</span><span style="color:#E06C75">br</span><span style="color:#ABB2BF">>{{ safe_option_b }} 概率 {{ prob_pair.1 }}%&#x3C;/</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">>{{ risky_option_a }} 概率 {{ prob_pair.0 }}%&#x3C;</span><span style="color:#E06C75">br</span><span style="color:#ABB2BF">>{{ risky_option_b }} 概率 {{ prob_pair.1 }}%&#x3C;/</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 1 }}{{ formfield player.decision_1 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 2 }}{{ formfield player.decision_2 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 3 }}{{ formfield player.decision_3 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 4 }}{{ formfield player.decision_4 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 5 }}{{ formfield player.decision_5 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 6 }}{{ formfield player.decision_6 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 7 }}{{ formfield player.decision_7 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 8 }}{{ formfield player.decision_8 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 9 }}{{ formfield player.decision_9 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                        {{ if forloop.counter == 10 }}{{ formfield player.decision_10 }}{{ endif }}</span></span>
<span class="line"><span style="color:#ABB2BF">                    &#x3C;/</span><span style="color:#E06C75">td</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">                &#x3C;/</span><span style="color:#E06C75">tr</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            {{ endfor }}</span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;/</span><span style="color:#E06C75">tbody</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;/</span><span style="color:#E06C75">table</span><span style="color:#ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    {{ next_button }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span></code></pre>
<p>最后是<code>Results.html</code>：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">{{ extends "global/Page.html" }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ load otree }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block title }}</span></span>
<span class="line"><span style="color:#ABB2BF">    实验结果</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">{{ block content }}</span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card"</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card-body"</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">h5</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"card-title"</span><span style="color:#ABB2BF">>支付计算&#x3C;/</span><span style="color:#E06C75">h5</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>系统随机选择了决策 {{ paying_decision }} 用于支付。&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>在这个决策中，高收益的概率为 {{ probability }}%。&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>您选择了 {{ choice }}。&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>结果是：{{ outcome }}收益。&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">            &#x3C;</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">>您的报酬为：{{ payoff }}。&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">        &#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">    &#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    {{ next_button }}</span></span>
<span class="line"><span style="color:#ABB2BF">{{ endblock }}</span></span>
<span class="line"></span></code></pre>
<p>从我的经验来看，使用Bootstrap卡片组件能使实验界面更加整洁美观，也便于参与者理解实验流程。</p>
<h2 id="第五步配置设置">第五步：配置设置</h2>
<p>编辑项目根目录下的<code>settings.py</code>文件，将你的应用包含进去：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#C678DD">from</span><span style="color:#ABB2BF"> os </span><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> environ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66">SESSION_CONFIGS</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#56B6C2">    dict</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'risk_preferences'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        display_name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"风险偏好实验"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        num_demo_participants</span><span style="color:#56B6C2">=</span><span style="color:#D19A66">10</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        app_sequence</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">'risk_preferences'</span><span style="color:#ABB2BF">],</span></span>
<span class="line"><span style="color:#ABB2BF">    ),</span></span>
<span class="line"><span style="color:#ABB2BF">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># 其他设置...</span></span>
<span class="line"><span style="color:#D19A66">LANGUAGE_CODE</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'zh-hans'</span><span style="color:#7F848E;font-style:italic">  # 设置为中文</span></span>
<span class="line"><span style="color:#D19A66">REAL_WORLD_CURRENCY_CODE</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'CNY'</span><span style="color:#7F848E;font-style:italic">  # 使用人民币</span></span>
<span class="line"><span style="color:#D19A66">USE_POINTS</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> False</span></span>
<span class="line"><span style="color:#D19A66">DEMO_PAGE_INTRO_HTML</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> ""</span></span>
<span class="line"><span style="color:#D19A66">PARTICIPANT_FIELDS</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> []</span></span>
<span class="line"><span style="color:#D19A66">SESSION_FIELDS</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66">ROOMS</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#56B6C2">    dict</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'econ_lab'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">        display_name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'经济学实验室'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">    ),</span></span>
<span class="line"><span style="color:#ABB2BF">]</span></span>
<span class="line"></span></code></pre>
<h2 id="第六步运行实验">第六步：运行实验</h2>
<p>现在你可以运行你的实验了：</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#61AFEF">otree</span><span style="color:#98C379"> devserver</span></span>
<span class="line"></span></code></pre>
<p>在浏览器中访问 <a href="http://localhost:8000">http://localhost:8000</a> 查看管理界面。在那里，你可以创建会话并测试你的实验。</p>
<h2 id="数据分析">数据分析</h2>
<p>收集数据后，你可以从管理界面以各种格式（CSV、Excel）下载数据。</p>
<h2 id="扩展与变种">扩展与变种</h2>
<p>这个基本结构可以扩展实现各种经济学实验：</p>
<ol>
<li><strong>公共品博弈</strong>：添加对群体账户的贡献和乘数效应</li>
<li><strong>最后通牒博弈</strong>：添加提议者/回应者角色及接受/拒绝决策</li>
<li><strong>信任博弈</strong>：添加顺序行动与投资回报决策</li>
<li><strong>市场实验</strong>：添加多个交易者的买卖决策</li>
</ol>
<h2 id="结论">结论</h2>
<p>至此，你已经成功搭建了一个完整的oTree风险偏好测量实验。这个基础为你实现更复杂的经济学实验提供了工具，同时保持了模型、页面和模板的核心结构。</p>
<p>作为一个有着多年经验的oTree实验设计者，我强烈建议在正式实验前进行充分的测试，并仔细考虑你的实验设计如何与经济理论相契合。记住，好的实验不仅仅是好的代码，更是精心设计的激励机制和清晰的参与者体验。</p>
<hr>
<p><strong>关于作者</strong>：Rowan是otree开发专家，专注于otree开发多年，经验丰富。</p>
<hr>
<p>本教程的完整代码可在以下仓库获取：<a href="https://github.com/The-Three-Fish/risk_preferences" target="_blank">github.com/The-Three-Fish/risk_preferences</a></p>
<p>该实验的heroku地址 => <a href="https://xd-risk-preferences-4a810d33050a.herokuapp.com/demo"></a><a href="https://xd-risk-preferences-4a810d33050a.herokuapp.com/demo">https://xd-risk-preferences-4a810d33050a.herokuapp.com/demo</a></p> <!-- <Markdown content={post.body} components={shortcodes} /> --> </div> </article> </div> </div> </div> </section>  </main> <footer class="section bg-theme-light pb-0"> <div class="container">  <div class="row"> <div class="mb-12 sm:col-6 lg:col-3"> <h2 class="h4">Company</h2> <ul class="mt-6"> <li class="mb-1"> <a href="/pricing" rel=""> Pricing </a> </li><li class="mb-1"> <a href="#" rel=""> Quick Start </a> </li> </ul> </div><div class="mb-12 sm:col-6 lg:col-3"> <h2 class="h4">Product</h2> <ul class="mt-6"> <li class="mb-1"> <a href="#" rel=""> Features </a> </li><li class="mb-1"> <a href="#" rel=""> Platform </a> </li><li class="mb-1"> <a href="/pricing" rel=""> Pricing </a> </li> </ul> </div><div class="mb-12 sm:col-6 lg:col-3"> <h2 class="h4">Support</h2> <ul class="mt-6"> <li class="mb-1"> <a href="/faq" rel=""> FAQ </a> </li><li class="mb-1"> <a href="/privacy-policy" rel=""> Privacy Policy </a> </li><li class="mb-1"> <a href="/terms-conditions" rel=""> Terms &amp; Conditions </a> </li> </ul> </div>  <div class="md-12 sm:col-6 lg:col-3"> <a href="/" aria-label="Bigspring"> <img src="/images/logo5.png" alt="" width="200" height="38" loading="lazy" decoding="async"> </a> <p class="mt-3 mb-6">一站式oTree开发服务，耐心细致的服务。一站式oTree开发服务，耐心细致的服务，确保项目顺利进行。专业团队，全程陪伴，满足您的需求。</p> <ul class="social-icons mb-8"> <li class="inline-block"> <a aria-label="facebook" href="https://facebook.com/" target="_blank" rel="noopener noreferrer nofollow"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M480 257.35c0-123.7-100.3-224-224-224s-224 100.3-224 224c0 111.8 81.9 204.47 189 221.29V322.12h-56.89v-64.77H221V208c0-56.13 33.45-87.16 84.61-87.16 24.51 0 50.15 4.38 50.15 4.38v55.13H327.5c-27.81 0-36.51 17.26-36.51 35v42h62.12l-9.92 64.77H291v156.54c107.1-16.81 189-109.48 189-221.31z"></path></svg> </a> </li> <li class="inline-block"> <a aria-label="twitter" href="https://twitter.com/" target="_blank" rel="noopener noreferrer nofollow"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M496 109.5a201.8 201.8 0 0 1-56.55 15.3 97.51 97.51 0 0 0 43.33-53.6 197.74 197.74 0 0 1-62.56 23.5A99.14 99.14 0 0 0 348.31 64c-54.42 0-98.46 43.4-98.46 96.9a93.21 93.21 0 0 0 2.54 22.1 280.7 280.7 0 0 1-203-101.3A95.69 95.69 0 0 0 36 130.4c0 33.6 17.53 63.3 44 80.7A97.5 97.5 0 0 1 35.22 199v1.2c0 47 34 86.1 79 95a100.76 100.76 0 0 1-25.94 3.4 94.38 94.38 0 0 1-18.51-1.8c12.51 38.5 48.92 66.5 92.05 67.3A199.59 199.59 0 0 1 39.5 405.6a203 203 0 0 1-23.5-1.4A278.68 278.68 0 0 0 166.74 448c181.36 0 280.44-147.7 280.44-275.8 0-4.2-.11-8.4-.31-12.5A198.48 198.48 0 0 0 496 109.5z"></path></svg> </a> </li>  <li class="inline-block"> <a aria-label="instagram" href="https://instagram.com/" target="_blank" rel="noopener noreferrer nofollow"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M349.33 69.33a93.62 93.62 0 0 1 93.34 93.34v186.66a93.62 93.62 0 0 1-93.34 93.34H162.67a93.62 93.62 0 0 1-93.34-93.34V162.67a93.62 93.62 0 0 1 93.34-93.34h186.66m0-37.33H162.67C90.8 32 32 90.8 32 162.67v186.66C32 421.2 90.8 480 162.67 480h186.66C421.2 480 480 421.2 480 349.33V162.67C480 90.8 421.2 32 349.33 32z"></path><path d="M377.33 162.67a28 28 0 1 1 28-28 27.94 27.94 0 0 1-28 28zM256 181.33A74.67 74.67 0 1 1 181.33 256 74.75 74.75 0 0 1 256 181.33m0-37.33a112 112 0 1 0 112 112 112 112 0 0 0-112-112z"></path></svg> </a> </li>  <li class="inline-block"> <a aria-label="linkedin" href="https://linkedin.com/" target="_blank" rel="noopener noreferrer nofollow"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M444.17 32H70.28C49.85 32 32 46.7 32 66.89v374.72C32 461.91 49.85 480 70.28 480h373.78c20.54 0 35.94-18.21 35.94-38.39V66.89C480.12 46.7 464.6 32 444.17 32zm-273.3 373.43h-64.18V205.88h64.18zM141 175.54h-.46c-20.54 0-33.84-15.29-33.84-34.43 0-19.49 13.65-34.42 34.65-34.42s33.85 14.82 34.31 34.42c-.01 19.14-13.31 34.43-34.66 34.43zm264.43 229.89h-64.18V296.32c0-26.14-9.34-44-32.56-44-17.74 0-28.24 12-32.91 23.69-1.75 4.2-2.22 9.92-2.22 15.76v113.66h-64.18V205.88h64.18v27.77c9.34-13.3 23.93-32.44 57.88-32.44 42.13 0 74 27.77 74 87.64z"></path></svg> </a> </li>                          </ul> </div> </div>  <div class="border-t border-border py-6 flex gap-2"> <p class="text-sm text-center">Designed and Developed By oTree Study</p> </div> </div> </footer> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-RN1NCJ00WE"></script>  </body> </html>